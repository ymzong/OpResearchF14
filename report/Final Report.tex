\documentclass{article} % For LaTeX2e
\usepackage{nips13submit_e,times}
%\usepackage{hyperref}
\usepackage[hyphens]{url}
\usepackage{bbm}
\usepackage{amsfonts}
\usepackage{alltt}
\usepackage{multirow, caption}
\usepackage{algorithm}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[noend]{algpseudocode}
\usepackage{etoolbox}
\usepackage{hyperref}
\usepackage{fancyvrb}
\usepackage{tgcursor}
\newcommand\userinput[1]{\textbf{#1}}
\newcommand\comment[1]{\textit{#1}}
\newcommand\stdout[1]{\textsl{#1}}

\makeatletter
\preto{\@verbatim}{\topsep=0pt \partopsep=0pt }
\makeatother

% Tweak algorithmic package.
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

\title{Operations Research II\\Final Report}

\author{
Keenan Gao \\
\And
Binghui Ouyang \\
\And
Hanwen Zhang \\
\And
Yiming Zong\\ \\
\and Department of Mathematical Sciences \\ Carnegie Mellon University \\ Pittsburgh, PA 15213
}

\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

\nipsfinalcopy % Uncomment for camera-ready version

\begin{document}

% Title
\maketitle

% Paper Abstract
\begin{abstract}
    Space reserved for abstract.
\end{abstract}

%
% Main Body Starts
%
\section{Problems Overview}
    \texttt{TODO: Overview of the problem in words.}


\section{Mathematical Model}
\subsection{General Input}
\begin{itemize}
    \item $n$: Number of students ($n > 0$);
    \item $m$: Number of seminars ($m > 0$);
    \item $k$: Max number of selections that a student can make ($1 \leq k \leq m$);
    \item $s_{i,j}$: The $j^{\text{th}}$ selection of $i^{\text{th}}$ student, where $1\leq i \leq n$ and $1\leq j \leq k$. $s_{i,j}=0$ when the Student $i$ makes no corresponding choice for Rank $j$;
    \item $q_k$: The quota for $k^{\text{th}}$ seminar, where $1\leq k \leq m$.
\end{itemize}

\subsection{Input Constraints}
\begin{itemize}
    \item Positivity: $n,m,k>0$, $\forall k\in\{1,\cdots,m\}, q_k>0$;
    \item Number of selections for student is bounded by number of available seminars: $k \leq m$;
    \item \textbf{(?)} Student rankings are valid and unique: $\forall (i,j), 1\leq s_{i,j} \leq m$. And, for each $i$, all non-zero entries $s_{i,j}$'s take unique values.
\end{itemize}

\subsection{Decision Variables}
\begin{itemize}
    \item $Y_{i,j}$: Indicator variables for whether Student $i$ is assigned to Seminar $j$, where $1\leq i \leq n$ and $1\leq j \leq k$;
\end{itemize}

\subsection{Data Pre-Processing}
    \par\qquad In order to deal with cases when a student is only willing or allowed to rank $k'<m$ seminars, we automatically set all ``unassigned'' priorities to $(k+1)$. Also, we change the representation of students' preference from \emph{(student, ranking) $\mapsto$ seminar} to \emph{(student, seminar) $\mapsto$ ranking} to make further calculations easier, i.e.
        $$X_{i,j}=\begin{cases}
                    l &\text{If Student $i$ ranked $j$ as $l^{\text{th}}$ option, or $s_{i,l}=j$ for some $l\in\{1,\cdots,k\}$}\\
                    k+1     &\text{If Seminar $k$ is not on Student $i$'s list, or $s_{i,l} \neq j$ for all $l\in\{1,\cdots,k\}$}
                  \end{cases}.$$

\subsection{General Constraints}
    \begin{itemize}
    \item $Y_{i,j}$'s are indeed indicator variables: $\forall (i,j), Y_{i,j}\in\mathbb{Z}, Y_{i,j}\geq 0, Y_{i,j}\leq 1$;
    \item Each student is assigned precisely one seminar: $\forall i$, $\sum_{l=1}^{m}{Y_{i,l}}=1$;
    \item Each seminar is within enrollment quota: $\forall j$, $\sum_{l=1}^{n}{Y_{l,j}} \leq q_j$;
\end{itemize}

%
% Heuristic Selection
%
\section{Approach for Various Heuristic Functions}
    \par\qquad Due to the flexibility of the original problem, we are proposing different objective functions for optimization, including minimizing the total ``rank'' given by the students, maximizing the number of student getting their top $\lambda k$ choice (where $\lambda\in(0,1)$), etc. In the following sub-sections we present our approach for each heuristic in mathematical terms.

\subsection{Minimize Total Rank of Students}
    \par\qquad In this case, our goal is to minimize the sum of all student rankings for their assigned seminars. To do so, our objective is to minimize $W = \sum_{i=1}^{n}{\sum_{j=1}^{m}{X_{i,j}Y_{i,j}}}.$
\subsection{Maximize Number of Students Getting Top-Tier Seminars}
    \par\qquad In this case, we would additionally require the user to input a value $\lambda\in(0,1)$, representing the range of rankings we consider as ``top-tier'', i.e. $\{1,\cdots,\lfloor \lambda k\rfloor\}$. Given this heuristic, our objective is to maximize $W = \sum_{i=1}^{n}{\sum_{j=1}^{m}{\mathbbm{1}_{X_{i,j} \leq \lfloor \lambda k\rfloor}Y_{i,j}}}.$

\subsection{And Potentially More}

%
% Optimization Algorithm
%
\section{Optimization Algorithm}
    \par\qquad Given the constraints, our goal is solve a \emph{Genrealized Assignment Problem}. According to Martello and Toth\cite{mt90}, it is \emph{NP-hard}, so an approximation algorithm must be applied in order to solve the problem in a reasonable amount of time. Analogous to the \emph{Knapsack Problem}, our fundamental approach is the greedy algorithm (with variations), and then make finishing touch based on the principle of \emph{Stable Marriage Problem}. Following sub-sections will present the alrogithm in details:

\subsection{Ranking-Based Greedy Algorithm}
    \par For the greedy algorithm, we first satisfy (a portion of) all students' first choices, then second choices, and so on. Depending on the ``popularity'' of each seminar, we may limit the number of students allowed to be added to a seminar at each ranking. The algorithm (as \emph{Algorithm 1} on next page) is outlined as follows, and it can be run multiple times in order to select an assignment with least amount of students that are not assigned to their ranked list.
    \begin{algorithm}
        \caption{Ranking-Based Greedy Algorithm}
        \begin{algorithmic}
            \Ensure{$\text{asgn}_i \gets \text{seminar assignment for Student $i$ based on greedy algorithm}$}
            \For{r = 1 to k}    
                \For{i = 1 to m}
                    \State pool[i] $\gets \{\text{unassigned student s} \mid \text{s listed seminar $i$ as $r^\text{th}$ choice}\}$
                    \State pool[i] $\gets \text{random subset of itself with certain size limit (e.g. seminar quota)}$
                \EndFor
                \State Merge each pool[i] into asgn
            \EndFor
            \State Fill in still unassigned students
        \end{algorithmic}
    \end{algorithm}

\subsection{Stable Assignment Optimization}
    \par Similar to the principle of \emph{Stable Marriage Problem}, in our final seminar assignment we do not want to have two students \emph{A} and \emph{B}, such that \emph{A} prefers \emph{B}'s section, and also vice versa (we call those two students \emph{rogue pair}). This can be done by scanning each pair of students and fixing every \emph{rogue pair}. The algorithm is outlined in \emph{Algorithm 2} on the next page.
    \begin{algorithm}
        \caption{Rogue-Pair Fixing Algorithm}
        \begin{algorithmic}
        \Require $\text{asgn}_i \gets \text{current seminar assignment for Student $i$}$
        \Ensure (i,j) if we found a rogue pair, otherwise null
        \Function{FindRoguePair}{\text{asgn}}
            \For {i=1 to n}
                \For {j=i+1 to n}
                    \If{Student $i$ and $j$ prefer each other's seminar}
                        \Return{(i,j)}
                    \EndIf
                \EndFor
            \EndFor
            \Return{null}
        \EndFunction
        
        \null
        
        \Require $\text{asgn}_i \gets \text{seminar assignment for Student $i$ based on greedy algorithm}$
        \Ensure $\text{asgn}_i$: rogue pair-free assignment for Student $i$
                \State p $\gets$ FindRoguePair(asgn)
                \While {p {\bf not} null}
                    \State (i,j) $\gets$ p
                    \State $\text{asgn}_i \leftrightarrow \text{asgn}_j$
                    \State p $\gets$ FindRoguePair(asgn)
                \EndWhile
        
        \end{algorithmic}
    \end{algorithm}

%
% Summary
%
\section{Summary of Results}

\section{Further Work \& Enhancements}

\urlstyle{rm}
\begin{thebibliography}{9}

\bibitem{mt90}
Martello, Silvano, and Paolo Toth. Knapsack Problems: Algorithms and Computer Implementations. Chichester: J. Wiley \& Sons, 1990. Print.
%\url{http://www.or.deis.unibo.it/kp/Chapter7.pdf}
\end{thebibliography}

\end{document}
